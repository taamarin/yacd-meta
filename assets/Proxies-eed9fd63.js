import{r as k,R as Q,p as z,b as s,j as u,B as _,s as x,a2 as qe,a3 as Ue,a4 as ge,a5 as He,d as S,c as O,a6 as Ge,O as E,a7 as Ze,a8 as we,a9 as ne,T as xe,N as Ke,F as G,aa as Ve,ab as Ye,ac as X,P as Qe,ad as Ce,ae as re,af as oe,ag as Xe,ah as Je,u as se,ai as et,aj as Le,ak as tt,g as Oe,C as ke,S as ae,al as nt,am as rt,an as ot,ao as st,ap as it}from"./index-65a9b64a.js";import{C as J,B as ce}from"./BaseModal-3769c7c1.js";import{F as at,p as ct,A as lt,I as ut}from"./Fab-87956e1a.js";import{R as dt,T as ht}from"./TextFitler-7a94197a.js";import{f as ft}from"./index-84fa0cb3.js";import{R as pt}from"./rotate-cw-72b4d2e4.js";import{S as vt}from"./Select-ccc391e9.js";import"./debounce-c1ba2006.js";function ee(){return ee=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},ee.apply(this,arguments)}function yt(e,t){if(e==null)return{};var n=mt(e,t),r,o;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(o=0;o<i.length;o++)r=i[o],!(t.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(e,r)&&(n[r]=e[r])}return n}function mt(e,t){if(e==null)return{};var n={},r=Object.keys(e),o,i;for(i=0;i<r.length;i++)o=r[i],!(t.indexOf(o)>=0)&&(n[o]=e[o]);return n}var ie=k.forwardRef(function(e,t){var n=e.color,r=n===void 0?"currentColor":n,o=e.size,i=o===void 0?24:o,a=yt(e,["color","size"]);return Q.createElement("svg",ee({ref:t,xmlns:"http://www.w3.org/2000/svg",width:i,height:i,viewBox:"0 0 24 24",fill:"none",stroke:r,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},a),Q.createElement("polygon",{points:"13 2 3 14 12 14 11 22 21 10 12 10 13 2"}))});ie.propTypes={color:z.string,size:z.oneOfType([z.string,z.number])};ie.displayName="Zap";const R=ie,_t="_FlexCenter_1380a_1",bt={FlexCenter:_t};function gt({children:e}){return s("div",{className:bt.FlexCenter,children:e})}const{useRef:le,useEffect:wt}=x;function xt({onClickPrimaryButton:e,onClickSecondaryButton:t}){const n=le(null),r=le(null);return wt(()=>{n.current.focus()},[]),u("div",{onKeyDown:i=>{i.keyCode===39?r.current.focus():i.keyCode===37&&n.current.focus()},children:[s("h2",{children:"Close Connections?"}),s("p",{children:"Click 'Yes' to close those connections that are still using the old selected proxy in this group"}),s("div",{style:{height:30}}),u(gt,{children:[s(_,{onClick:e,ref:n,children:"Yes"}),s("div",{style:{width:20}}),s(_,{onClick:t,ref:r,children:"No"})]})]})}const Ct="_header_19ilz_1",Lt="_arrow_19ilz_9",Ot="_isOpen_19ilz_14",kt="_btn_19ilz_21",Pt="_qty_19ilz_26",ue={header:Ct,arrow:Lt,isOpen:Ot,btn:kt,qty:Pt};function Pe({name:e,type:t,toggle:n,qty:r}){const o=k.useCallback(i=>{i.preventDefault(),(i.key==="Enter"||i.key===" ")&&n()},[n]);return u("div",{className:ue.header,onClick:n,style:{cursor:"pointer"},tabIndex:0,onKeyDown:o,role:"button",children:[s("div",{children:s(qe,{name:e,type:t})}),typeof r=="number"?s("span",{className:ue.qty,children:r}):null]})}const{useMemo:Et}=x;function Tt(e,t){return e.filter(n=>{const r=t[n];return r===void 0?!0:r.number!==0})}const F=(e,t)=>{if(e&&typeof e.number=="number"&&e.number>0)return e.number;const n=t&&t.type;return n&&He.indexOf(n)>-1?-1:999999},St={Natural:e=>e,LatencyAsc:(e,t,n)=>e.sort((r,o)=>{const i=F(t[r],n&&n[r]),a=F(t[o],n&&n[o]);return i-a}),LatencyDesc:(e,t,n)=>e.sort((r,o)=>{const i=F(t[r],n&&n[r]);return F(t[o],n&&n[o])-i}),NameAsc:e=>e.sort(),NameDesc:e=>e.sort((t,n)=>t>n?-1:t<n?1:0)};function Rt(e,t){const n=t.toLowerCase().split(" ").map(r=>r.trim()).filter(r=>!!r);return n.length===0?e:e.filter(r=>{let o=0;for(;o<n.length;o++){const i=n[o];if(r.toLowerCase().indexOf(i)>-1)return!0}return!1})}function Mt(e,t,n,r,o,i){let a=[...e];return n&&(a=Tt(e,t)),typeof r=="string"&&r!==""&&(a=Rt(a,r)),St[o](a,t,i)}function Ee(e,t,n,r,o){const[i]=Ue(ge);return Et(()=>Mt(e,t,n,i,r,o),[e,t,n,i,r,o])}const Nt="_header_1qjca_1",At="_group_1qjca_5",$t="_zapWrapper_1qjca_12",Dt="_arrow_1qjca_20",Bt="_isOpen_1qjca_25",b={header:Nt,group:At,zapWrapper:$t,arrow:Dt,isOpen:Bt},Te={Right:39,Left:37,Enter:13,Space:32},zt="_proxy_1av1x_4",Ft="_now_1av1x_24",Wt="_error_1av1x_28",jt="_selectable_1av1x_31",It="_proxyType_1av1x_39",qt="_udpType_1av1x_49",Ut="_tfoType_1av1x_60",Ht="_row_1av1x_64",Gt="_proxyName_1av1x_72",Zt="_proxySmall_1av1x_83",v={proxy:zt,now:Ft,error:Wt,selectable:jt,proxyType:It,udpType:qt,tfoType:Ut,row:Ht,proxyName:Gt,proxySmall:Zt},Kt="_proxyLatency_12uqm_4",Vt={proxyLatency:Kt};function Yt({number:e,color:t}){return s("span",{className:Vt.proxyLatency,style:{color:t},children:u("span",{children:[e," ms"]})})}const{useMemo:I}=x,P={good:"#67c23a",normal:"#d4b75c",bad:"#e67f3c",danger:"#ff8da1",na:"#909399"};function Se({number:e}={},t){const n={good:t?800:200,normal:t?1500:500,bad:t?2e3:800,danger:t?2700:1200};return e===0?P.na:e<n.good?P.good:e<n.normal?P.normal:e<n.bad?P.bad:typeof e=="number"?P.danger:P.na}function Qt(e,t){return Se(e,t)}function Xt({now:e,name:t,proxy:n,latency:r,httpsLatencyTest:o,isSelectable:i,onClick:a}){var y;const c=(y=n.history[n.history.length-1])==null?void 0:y.delay,l=(r==null?void 0:r.number)??c,f=I(()=>Qt({number:l},o),[l]),d=I(()=>{let p=t;return r&&typeof r.number=="number"&&(p+=" "+r.number+" ms"),p},[t,r]),h=k.useCallback(()=>{i&&a&&a(t)},[t,a,i]),m=k.useCallback(p=>{p.keyCode===Te.Enter&&h()},[h]);return s("div",{title:d,className:O(v.proxySmall,{[v.selectable]:i}),style:{background:f,scale:e?"1.2":"1"},onClick:h,onKeyDown:m,role:i?"menuitem":"",children:e&&s("div",{className:v.now})})}function Jt(e){return e==="Shadowsocks"?"SS":e}const en=e=>({left:e.left+window.scrollX-5,top:e.top+window.scrollY-38});function tn({children:e,label:t,"aria-label":n}){const[r,o]=Ge();return u(E,{children:[k.cloneElement(e,r),s(Ze,{...o,label:t,"aria-label":n,position:en})]})}function nn({now:e,name:t,proxy:n,latency:r,httpsLatencyTest:o,isSelectable:i,onClick:a}){var C;const c=(C=n.history[n.history.length-1])==null?void 0:C.delay,l=(r==null?void 0:r.number)??c,f=I(()=>Se({number:l},o),[l]),d=k.useCallback(()=>{i&&a&&a(t)},[t,a,i]);function h(g,L){return g?L?"xudp":"udp":""}function m(g){return g?s("svg",{xmlns:"http://www.w3.org/2000/svg",width:"8",height:"8",viewBox:"0 0 15 15",fill:"#000",children:s("path",{"fill-rule":"evenodd","clip-rule":"evenodd",d:"M6.85357 3.85355L7.65355 3.05353C8.2981 2.40901 9.42858 1.96172 10.552 1.80125C11.1056 1.72217 11.6291 1.71725 12.0564 1.78124C12.4987 1.84748 12.7698 1.97696 12.8965 2.10357C13.0231 2.23018 13.1526 2.50125 13.2188 2.94357C13.2828 3.37086 13.2779 3.89439 13.1988 4.44801C13.0383 5.57139 12.591 6.70188 11.9464 7.34645L7.49999 11.7929L6.35354 10.6465C6.15827 10.4512 5.84169 10.4512 5.64643 10.6465C5.45117 10.8417 5.45117 11.1583 5.64643 11.3536L7.14644 12.8536C7.34171 13.0488 7.65829 13.0488 7.85355 12.8536L8.40073 12.3064L9.57124 14.2572C9.65046 14.3893 9.78608 14.4774 9.9389 14.4963C10.0917 14.5151 10.2447 14.4624 10.3535 14.3536L12.3535 12.3536C12.4648 12.2423 12.5172 12.0851 12.495 11.9293L12.0303 8.67679L12.6536 8.05355C13.509 7.19808 14.0117 5.82855 14.1887 4.58943C14.2784 3.9618 14.2891 3.33847 14.2078 2.79546C14.1287 2.26748 13.9519 1.74482 13.6035 1.39645C13.2552 1.04809 12.7325 0.871332 12.2045 0.792264C11.6615 0.710945 11.0382 0.721644 10.4105 0.8113C9.17143 0.988306 7.80189 1.491 6.94644 2.34642L6.32322 2.96968L3.07071 2.50504C2.91492 2.48278 2.75773 2.53517 2.64645 2.64646L0.646451 4.64645C0.537579 4.75533 0.484938 4.90829 0.50375 5.0611C0.522563 5.21391 0.61073 5.34954 0.742757 5.42876L2.69364 6.59928L2.14646 7.14645C2.0527 7.24022 2.00002 7.3674 2.00002 7.50001C2.00002 7.63261 2.0527 7.75979 2.14646 7.85356L3.64647 9.35356C3.84173 9.54883 4.15831 9.54883 4.35357 9.35356C4.54884 9.1583 4.54884 8.84172 4.35357 8.64646L3.20712 7.50001L3.85357 6.85356L6.85357 3.85355ZM10.0993 13.1936L9.12959 11.5775L11.1464 9.56067L11.4697 11.8232L10.0993 13.1936ZM3.42251 5.87041L5.43935 3.85356L3.17678 3.53034L1.80638 4.90074L3.42251 5.87041ZM2.35356 10.3535C2.54882 10.1583 2.54882 9.8417 2.35356 9.64644C2.1583 9.45118 1.84171 9.45118 1.64645 9.64644L0.646451 10.6464C0.451188 10.8417 0.451188 11.1583 0.646451 11.3535C0.841713 11.5488 1.1583 11.5488 1.35356 11.3535L2.35356 10.3535ZM3.85358 11.8536C4.04884 11.6583 4.04885 11.3417 3.85359 11.1465C3.65833 10.9512 3.34175 10.9512 3.14648 11.1465L1.14645 13.1464C0.95119 13.3417 0.951187 13.6583 1.14645 13.8535C1.34171 14.0488 1.65829 14.0488 1.85355 13.8536L3.85358 11.8536ZM5.35356 13.3535C5.54882 13.1583 5.54882 12.8417 5.35356 12.6464C5.1583 12.4512 4.84171 12.4512 4.64645 12.6464L3.64645 13.6464C3.45119 13.8417 3.45119 14.1583 3.64645 14.3535C3.84171 14.5488 4.1583 14.5488 4.35356 14.3535L5.35356 13.3535ZM9.49997 6.74881C10.1897 6.74881 10.7488 6.1897 10.7488 5.5C10.7488 4.8103 10.1897 4.25118 9.49997 4.25118C8.81026 4.25118 8.25115 4.8103 8.25115 5.5C8.25115 6.1897 8.81026 6.74881 9.49997 6.74881Z"})}):null}const y=k.useCallback(g=>{g.keyCode===Te.Enter&&d()},[d]),p=I(()=>O(v.proxy,{[v.now]:e,[v.error]:r&&r.error,[v.selectable]:i}),[i,e,r]);return u("div",{tabIndex:0,className:p,onClick:d,onKeyDown:y,role:i?"menuitem":"",children:[s("div",{className:O(v.proxyName,v.row),children:s(tn,{label:t,"aria-label":`proxy name: ${t}`,children:s("span",{children:t})})}),s("div",{className:v.row,children:u("div",{className:v.row,children:[s("span",{className:`${v.proxyType} ${v.tfoLabel}`,style:{padding:"2px 2px",paddingRight:2,paddingLeft:2,opacity:.7,color:"#fff",backgroundColor:f,borderRadius:2,fontWeight:"bold",fontStyle:""},children:Jt(n.type)})," ",s("span",{className:`${v.proxyType} ${v.tfoLabel}`,style:{padding:"2px 2px",paddingRight:2,paddingLeft:2,opacity:.7,color:"#fff",backgroundColor:f,borderRadius:2,fontWeight:"bold",fontStyle:""},children:h(n.udp,n.xudp)})," ",s("span",{className:`${v.proxyType} ${v.tfoLabel}`,style:{padding:"2px 2px",paddingRight:2,paddingLeft:2,opacity:.7,backgroundColor:"#fff",borderRadius:2,fontWeight:"bold",fontStyle:""},children:l?s(Yt,{number:l,color:f}):null})," ",s("span",{className:`${v.proxyType} ${v.tfoLabel}`,style:{padding:"2px 2px",paddingRight:2,paddingLeft:2,opacity:.7,backgroundColor:"#fff",borderRadius:2,fontWeight:"",fontStyle:""},children:m(n.tfo)})]})})]})}const Re=(e,{name:t})=>{const n=we(e),r=ne(e),o=xe(e);return{proxy:n[t]||{name:t,history:[]},latency:r[t],httpsLatencyTest:o.startsWith("https://")}},rn=S(Re)(nn),on=S(Re)(Xt),sn="_list_4awfc_4",an="_detail_4awfc_10",cn="_summary_4awfc_19",q={list:sn,detail:an,summary:cn};function Me({all:e,now:t,isSelectable:n,itemOnTapCallback:r}){const o=e;return s("div",{className:O(q.list,q.detail),children:o.map(i=>s(rn,{onClick:r,isSelectable:n,name:i,now:i===t},i))})}function Ne({all:e,now:t,isSelectable:n,itemOnTapCallback:r}){return s("div",{className:O(q.list,q.summary),children:e.map(o=>s(on,{onClick:r,isSelectable:n,name:o,now:o===t},o))})}const{createElement:ln,useCallback:V,useMemo:un,useState:de,useEffect:dn}=x;function he(){return s("div",{className:b.zapWrapper,children:s(R,{size:16})})}function hn({name:e,all:t,delay:n,hideUnavailableProxies:r,proxySortBy:o,proxies:i,type:a,now:c,isOpen:l,latencyTestUrl:f,apiConfig:d,dispatch:h}){const m=Ee(t,n,r,o,i),{data:y}=Ke(["/version",d],()=>Qe("/version",d)),p=un(()=>["Selector",y.meta&&"Fallback",y.meta&&"URLTest"].includes(a),[a,y.meta]),{app:{updateCollapsibleIsOpen:C},proxies:{requestDelayForProxies:g}}=G(),L=V(()=>{C("proxyGroup",e,!l)},[l,C,e]),K=V(B=>{p&&h(Ve(d,e,B))},[d,h,e,p]),[M,N]=de(!1),A=V(async()=>{N(!0);try{y.meta===!0?(await Ye(d,e,f),await h(X(d))):(await g(d,m),await h(X(d)))}catch{}N(!1)},[m,d,h,e,y.meta]),[$,w]=de(window.innerWidth),D=()=>{w(window.innerWidth)};return dn(()=>(window.addEventListener("resize",D),()=>window.removeEventListener("resize",D)),[]),u("div",{className:b.group,children:[u("div",{style:{display:"flex",alignItems:"center",justifyContent:$>768?"start":"space-between"},children:[s(Pe,{name:e,type:a,toggle:L,qty:m.length}),s("div",{style:{display:"flex"},children:$>768?u(E,{children:[s(_,{kind:"minimal",onClick:L,className:b.btn,title:"Toggle collapsible section",children:s("span",{className:O(b.arrow,{[b.isOpen]:l}),children:s(J,{size:20})})}),s(_,{title:"Test latency",kind:"minimal",onClick:A,isLoading:M,children:s(he,{})})]}):u(E,{children:[s(_,{title:"Test latency",kind:"minimal",onClick:A,isLoading:M,children:s(he,{})}),s(_,{kind:"minimal",onClick:L,className:b.btn,title:"Toggle collapsible section",children:s("span",{className:O(b.arrow,{[b.isOpen]:l}),children:s(J,{size:20})})})]})})]}),ln(l?Me:Ne,{all:m,now:c,isSelectable:p,itemOnTapCallback:K})]})}const fn=S((e,{name:t,delay:n})=>{const r=we(e),o=Ce(e),i=re(e),a=oe(e),c=xe(e),l=r[t],{all:f,type:d,now:h}=l;return{all:f,delay:n,hideUnavailableProxies:a,proxySortBy:i,proxies:r,type:d,now:h,isOpen:o[`proxyGroup:${t}`],latencyTestUrl:c}})(hn),{useCallback:Ae,useState:pn}=x;function vn({dispatch:e,apiConfig:t,name:n}){return Ae(()=>e(Xe(t,n)),[t,e,n])}function yn({dispatch:e,apiConfig:t,names:n}){const[r,o]=pn(!1);return[Ae(async()=>{if(!r){o(!0);try{await e(Je(t,n))}catch{}o(!1)}},[t,e,n,r]),r]}const{useState:mn,useCallback:_n}=x;function bn({isLoading:e}){return e?s(ut,{children:s(R,{width:16,height:16})}):s(R,{width:16,height:16})}function gn({dispatch:e,apiConfig:t}){const[n,r]=mn(!1);return[_n(()=>{n||(r(!0),e(et(t)).then(()=>r(!1),()=>r(!1)))},[t,e,n]),n]}function wn({dispatch:e,apiConfig:t,proxyProviders:n}){const{t:r}=se(),[o,i]=gn({dispatch:e,apiConfig:t}),[a,c]=yn({apiConfig:t,dispatch:e,names:n.map(l=>l.name)});return s(at,{icon:s(bn,{isLoading:i}),onClick:o,text:r("Test Latency"),style:ct,children:n.length>0?s(lt,{text:r("update_all_proxy_provider"),onClick:a,children:s(dt,{isRotating:c})}):null})}var $e=function(){if(typeof Map<"u")return Map;function e(t,n){var r=-1;return t.some(function(o,i){return o[0]===n?(r=i,!0):!1}),r}return function(){function t(){this.__entries__=[]}return Object.defineProperty(t.prototype,"size",{get:function(){return this.__entries__.length},enumerable:!0,configurable:!0}),t.prototype.get=function(n){var r=e(this.__entries__,n),o=this.__entries__[r];return o&&o[1]},t.prototype.set=function(n,r){var o=e(this.__entries__,n);~o?this.__entries__[o][1]=r:this.__entries__.push([n,r])},t.prototype.delete=function(n){var r=this.__entries__,o=e(r,n);~o&&r.splice(o,1)},t.prototype.has=function(n){return!!~e(this.__entries__,n)},t.prototype.clear=function(){this.__entries__.splice(0)},t.prototype.forEach=function(n,r){r===void 0&&(r=null);for(var o=0,i=this.__entries__;o<i.length;o++){var a=i[o];n.call(r,a[1],a[0])}},t}()}(),te=typeof window<"u"&&typeof document<"u"&&window.document===document,U=function(){return typeof global<"u"&&global.Math===Math?global:typeof self<"u"&&self.Math===Math?self:typeof window<"u"&&window.Math===Math?window:Function("return this")()}(),xn=function(){return typeof requestAnimationFrame=="function"?requestAnimationFrame.bind(U):function(e){return setTimeout(function(){return e(Date.now())},1e3/60)}}(),Cn=2;function Ln(e,t){var n=!1,r=!1,o=0;function i(){n&&(n=!1,e()),r&&c()}function a(){xn(i)}function c(){var l=Date.now();if(n){if(l-o<Cn)return;r=!0}else n=!0,r=!1,setTimeout(a,t);o=l}return c}var On=20,kn=["top","right","bottom","left","width","height","size","weight"],Pn=typeof MutationObserver<"u",En=function(){function e(){this.connected_=!1,this.mutationEventsAdded_=!1,this.mutationsObserver_=null,this.observers_=[],this.onTransitionEnd_=this.onTransitionEnd_.bind(this),this.refresh=Ln(this.refresh.bind(this),On)}return e.prototype.addObserver=function(t){~this.observers_.indexOf(t)||this.observers_.push(t),this.connected_||this.connect_()},e.prototype.removeObserver=function(t){var n=this.observers_,r=n.indexOf(t);~r&&n.splice(r,1),!n.length&&this.connected_&&this.disconnect_()},e.prototype.refresh=function(){var t=this.updateObservers_();t&&this.refresh()},e.prototype.updateObservers_=function(){var t=this.observers_.filter(function(n){return n.gatherActive(),n.hasActive()});return t.forEach(function(n){return n.broadcastActive()}),t.length>0},e.prototype.connect_=function(){!te||this.connected_||(document.addEventListener("transitionend",this.onTransitionEnd_),window.addEventListener("resize",this.refresh),Pn?(this.mutationsObserver_=new MutationObserver(this.refresh),this.mutationsObserver_.observe(document,{attributes:!0,childList:!0,characterData:!0,subtree:!0})):(document.addEventListener("DOMSubtreeModified",this.refresh),this.mutationEventsAdded_=!0),this.connected_=!0)},e.prototype.disconnect_=function(){!te||!this.connected_||(document.removeEventListener("transitionend",this.onTransitionEnd_),window.removeEventListener("resize",this.refresh),this.mutationsObserver_&&this.mutationsObserver_.disconnect(),this.mutationEventsAdded_&&document.removeEventListener("DOMSubtreeModified",this.refresh),this.mutationsObserver_=null,this.mutationEventsAdded_=!1,this.connected_=!1)},e.prototype.onTransitionEnd_=function(t){var n=t.propertyName,r=n===void 0?"":n,o=kn.some(function(i){return!!~r.indexOf(i)});o&&this.refresh()},e.getInstance=function(){return this.instance_||(this.instance_=new e),this.instance_},e.instance_=null,e}(),De=function(e,t){for(var n=0,r=Object.keys(t);n<r.length;n++){var o=r[n];Object.defineProperty(e,o,{value:t[o],enumerable:!1,writable:!1,configurable:!0})}return e},T=function(e){var t=e&&e.ownerDocument&&e.ownerDocument.defaultView;return t||U},Be=Z(0,0,0,0);function H(e){return parseFloat(e)||0}function fe(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];return t.reduce(function(r,o){var i=e["border-"+o+"-width"];return r+H(i)},0)}function Tn(e){for(var t=["top","right","bottom","left"],n={},r=0,o=t;r<o.length;r++){var i=o[r],a=e["padding-"+i];n[i]=H(a)}return n}function Sn(e){var t=e.getBBox();return Z(0,0,t.width,t.height)}function Rn(e){var t=e.clientWidth,n=e.clientHeight;if(!t&&!n)return Be;var r=T(e).getComputedStyle(e),o=Tn(r),i=o.left+o.right,a=o.top+o.bottom,c=H(r.width),l=H(r.height);if(r.boxSizing==="border-box"&&(Math.round(c+i)!==t&&(c-=fe(r,"left","right")+i),Math.round(l+a)!==n&&(l-=fe(r,"top","bottom")+a)),!Nn(e)){var f=Math.round(c+i)-t,d=Math.round(l+a)-n;Math.abs(f)!==1&&(c-=f),Math.abs(d)!==1&&(l-=d)}return Z(o.left,o.top,c,l)}var Mn=function(){return typeof SVGGraphicsElement<"u"?function(e){return e instanceof T(e).SVGGraphicsElement}:function(e){return e instanceof T(e).SVGElement&&typeof e.getBBox=="function"}}();function Nn(e){return e===T(e).document.documentElement}function An(e){return te?Mn(e)?Sn(e):Rn(e):Be}function $n(e){var t=e.x,n=e.y,r=e.width,o=e.height,i=typeof DOMRectReadOnly<"u"?DOMRectReadOnly:Object,a=Object.create(i.prototype);return De(a,{x:t,y:n,width:r,height:o,top:n,right:t+r,bottom:o+n,left:t}),a}function Z(e,t,n,r){return{x:e,y:t,width:n,height:r}}var Dn=function(){function e(t){this.broadcastWidth=0,this.broadcastHeight=0,this.contentRect_=Z(0,0,0,0),this.target=t}return e.prototype.isActive=function(){var t=An(this.target);return this.contentRect_=t,t.width!==this.broadcastWidth||t.height!==this.broadcastHeight},e.prototype.broadcastRect=function(){var t=this.contentRect_;return this.broadcastWidth=t.width,this.broadcastHeight=t.height,t},e}(),Bn=function(){function e(t,n){var r=$n(n);De(this,{target:t,contentRect:r})}return e}(),zn=function(){function e(t,n,r){if(this.activeObservations_=[],this.observations_=new $e,typeof t!="function")throw new TypeError("The callback provided as parameter 1 is not a function.");this.callback_=t,this.controller_=n,this.callbackCtx_=r}return e.prototype.observe=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(t instanceof T(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var n=this.observations_;n.has(t)||(n.set(t,new Dn(t)),this.controller_.addObserver(this),this.controller_.refresh())}},e.prototype.unobserve=function(t){if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");if(!(typeof Element>"u"||!(Element instanceof Object))){if(!(t instanceof T(t).Element))throw new TypeError('parameter 1 is not of type "Element".');var n=this.observations_;n.has(t)&&(n.delete(t),n.size||this.controller_.removeObserver(this))}},e.prototype.disconnect=function(){this.clearActive(),this.observations_.clear(),this.controller_.removeObserver(this)},e.prototype.gatherActive=function(){var t=this;this.clearActive(),this.observations_.forEach(function(n){n.isActive()&&t.activeObservations_.push(n)})},e.prototype.broadcastActive=function(){if(this.hasActive()){var t=this.callbackCtx_,n=this.activeObservations_.map(function(r){return new Bn(r.target,r.broadcastRect())});this.callback_.call(t,n,t),this.clearActive()}},e.prototype.clearActive=function(){this.activeObservations_.splice(0)},e.prototype.hasActive=function(){return this.activeObservations_.length>0},e}(),ze=typeof WeakMap<"u"?new WeakMap:new $e,Fe=function(){function e(t){if(!(this instanceof e))throw new TypeError("Cannot call a class as a function.");if(!arguments.length)throw new TypeError("1 argument required, but only 0 present.");var n=En.getInstance(),r=new zn(t,n,this);ze.set(this,r)}return e}();["observe","unobserve","disconnect"].forEach(function(e){Fe.prototype[e]=function(){var t;return(t=ze.get(this))[e].apply(t,arguments)}});var Fn=function(){return typeof U.ResizeObserver<"u"?U.ResizeObserver:Fe}();const{memo:Wn,useState:jn,useRef:We,useEffect:je}=Q;function In(e){const t=We();return je(()=>void(t.current=e),[e]),t.current}function qn(){const e=We(),[t,n]=jn({height:0});return je(()=>{const r=new Fn(([o])=>n(o.contentRect));return e.current&&r.observe(e.current),()=>r.disconnect()},[]),[e,t]}const Un={initialOpen:{height:"auto",transition:{duration:0}},open:e=>({height:e,opacity:1,visibility:"visible",transition:{duration:.3}}),closed:{height:0,opacity:0,visibility:"hidden",overflowY:"hidden",transition:{duration:.3}}},Hn={open:{},closed:{}},pe=Wn(({children:e,isOpen:t})=>{const r=Le.read().motion,o=In(t),[i,{height:a}]=qn();return s("div",{children:s(r.div,{animate:t&&o===t?"initialOpen":t?"open":"closed",custom:a,variants:Un,children:s(r.div,{variants:Hn,ref:i,children:e})})})}),Gn="_updatedAt_1d817_4",Zn="_body_1d817_12",Kn="_actionFooter_1d817_25",Vn="_refresh_1d817_35",j={updatedAt:Gn,body:Zn,actionFooter:Kn,refresh:Vn},{useState:Yn,useCallback:ve}=x;function Qn({name:e,proxies:t,delay:n,hideUnavailableProxies:r,proxySortBy:o,vehicleType:i,updatedAt:a,subscriptionInfo:c,isOpen:l,dispatch:f,apiConfig:d}){const h=Ee(t,n,r,o),[m,y]=Yn(!1),p=vn({dispatch:f,apiConfig:d,name:e}),C=ve(async()=>{y(!0),await f(tt(d,e)),y(!1)},[d,f,e,y]),{app:{updateCollapsibleIsOpen:g}}=G(),L=ve(()=>{g("proxyProvider",e,!l)},[l,g,e]),K=ft(new Date(a),new Date),M=c?ye(c.Total):0,N=c?ye(c.Download+c.Upload):0,A=c?((c.Download+c.Upload)/c.Total*100).toFixed(2):0,$=()=>{if(c.Expire===0)return"Null";const w=new Date(c.Expire*1e3),D=w.getFullYear()+"-",B=(w.getMonth()+1<10?"0"+(w.getMonth()+1):w.getMonth()+1)+"-",Ie=(w.getDate()<10?"0"+w.getDate():w.getDate())+" ";return D+B+Ie};return u("div",{className:j.body,children:[u("div",{style:{display:"flex",alignItems:"center",flexWrap:"wrap",justifyContent:"space-between"},children:[s(Pe,{name:e,toggle:L,type:i,isOpen:l,qty:h.length}),u("div",{style:{display:"flex"},children:[s(_,{kind:"minimal",onClick:L,className:b.btn,title:"Toggle collapsible section",children:s("span",{className:O(b.arrow,{[b.isOpen]:l}),children:s(J,{size:20})})}),s(_,{kind:"minimal",start:s(me,{}),onClick:p}),s(_,{kind:"minimal",start:s(R,{size:16}),onClick:C,isLoading:m})]})]}),u("div",{className:j.updatedAt,children:[c&&u("small",{children:[N," / ",M," ( ",A,"% )    Expire: ",$()," "]}),s("br",{}),u("small",{children:["Updated ",K," ago"]})]}),u(pe,{isOpen:l,children:[s(Me,{all:h}),u("div",{className:j.actionFooter,children:[s(_,{text:"Update",start:s(me,{}),onClick:p}),s(_,{text:"Health Check",start:s(R,{size:16}),onClick:C,isLoading:m})]})]}),s(pe,{isOpen:!l,children:s(Ne,{all:h})})]})}const Xn={rest:{scale:1},pressed:{scale:.95}},Jn={rest:{rotate:0},hover:{rotate:360,transition:{duration:.3}}};function ye(e,t=2){if(!+e)return"0 Bytes";const n=1024,r=t<0?0:t,o=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],i=Math.floor(Math.log(e)/Math.log(n));return`${parseFloat((e/Math.pow(n,i)).toFixed(r))} ${o[i]}`}function me(){const t=Le.read().motion;return s(t.div,{className:j.refresh,variants:Xn,initial:"rest",whileHover:"hover",whileTap:"pressed",children:s(t.div,{className:"flexCenter",variants:Jn,children:s(pt,{size:16})})})}const er=(e,{proxies:t,name:n})=>{const r=oe(e),o=ne(e),i=Ce(e),a=Oe(e),c=re(e);return{apiConfig:a,proxies:t,delay:o,hideUnavailableProxies:r,proxySortBy:c,isOpen:i[`proxyProvider:${n}`]}},tr=S(er)(Qn);function nr({items:e}){return e.length===0?null:u(E,{children:[s(ke,{title:"Proxy Provider"}),s("div",{children:e.map(t=>s(tr,{name:t.name,proxies:t.proxies,type:t.type,vehicleType:t.vehicleType,updatedAt:t.updatedAt,subscriptionInfo:t.subscriptionInfo},t.name))})]})}const rr="_labeledInput_cmki0_1",Y={labeledInput:rr},or=[["Natural","order_natural"],["LatencyAsc","order_latency_asc"],["LatencyDesc","order_latency_desc"],["NameAsc","order_name_asc"],["NameDesc","order_name_desc"]],{useCallback:_e}=x;function sr({appConfig:e}){const{app:{updateAppConfig:t}}=G(),n=_e(i=>{t("proxySortBy",i.target.value)},[t]),r=_e(i=>{t("hideUnavailableProxies",i)},[t]),{t:o}=se();return u(E,{children:[u("div",{className:Y.labeledInput,children:[s("span",{children:o("sort_in_grp")}),s("div",{children:s(vt,{options:or.map(i=>[i[0],o(i[1])]),selected:e.proxySortBy,onChange:n})})]}),s("hr",{}),u("div",{className:Y.labeledInput,children:[s("span",{children:o("hide_unavail_proxies")}),s("div",{children:s(ae,{name:"hideUnavailableProxies",checked:e.hideUnavailableProxies,onChange:r})})]}),u("div",{className:Y.labeledInput,children:[s("span",{children:o("auto_close_conns")}),s("div",{children:s(ae,{name:"autoCloseOldConns",checked:e.autoCloseOldConns,onChange:i=>t("autoCloseOldConns",i)})})]})]})}const ir=e=>{const t=re(e),n=oe(e),r=nt(e);return{appConfig:{proxySortBy:t,hideUnavailableProxies:n,autoCloseOldConns:r}}},ar=S(ir)(sr);function cr({color:e="currentColor",size:t=24}){return u("svg",{fill:"none",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",width:t,height:t,stroke:e,strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[s("path",{d:"M2 6h9M18.5 6H22"}),s("circle",{cx:"16",cy:"6",r:"2"}),s("path",{d:"M22 18h-9M6 18H2"}),s("circle",{r:"2",transform:"matrix(-1 0 0 1 8 18)"})]})}const lr="_topBar_15n7g_4",ur="_topBarRight_15n7g_16",dr="_textFilterContainer_15n7g_25",hr="_group_15n7g_32",W={topBar:lr,topBarRight:ur,textFilterContainer:dr,group:hr},{useState:fr,useEffect:pr,useCallback:be,useRef:vr}=x;function yr({dispatch:e,groupNames:t,delay:n,proxyProviders:r,apiConfig:o,showModalClosePrevConns:i}){const a=vr({}),c=be(()=>{a.current.startAt=Date.now(),e(X(o)).then(()=>{a.current.completeAt=Date.now()})},[o,e]);pr(()=>{c();const p=()=>{a.current.startAt&&Date.now()-a.current.startAt>3e4&&c()};return window.addEventListener("focus",p,!1),()=>window.removeEventListener("focus",p,!1)},[c]);const[l,f]=fr(!1),d=be(()=>{f(!1)},[]),{proxies:{closeModalClosePrevConns:h,closePrevConnsAndTheModal:m}}=G(),{t:y}=se();return u(E,{children:[s(ce,{isOpen:l,onRequestClose:d,children:s(ar,{})}),u("div",{className:W.topBar,children:[s(ke,{title:y("Proxies")}),u("div",{className:W.topBarRight,children:[s("div",{className:W.textFilterContainer,children:s(ht,{textAtom:ge,placeholder:y("Search")})}),s(rt,{label:y("settings"),children:s(_,{kind:"minimal",onClick:()=>f(!0),children:s(cr,{size:16})})})]})]}),s("div",{children:t.map(p=>s("div",{className:W.group,children:s(fn,{name:p,delay:n,apiConfig:o,dispatch:e})},p))}),s(nr,{items:r}),s("div",{style:{height:60}}),s(wn,{dispatch:e,apiConfig:o,proxyProviders:r}),s(ce,{isOpen:i,onRequestClose:h,children:s(xt,{onClickPrimaryButton:()=>m(o),onClickSecondaryButton:h})})]})}const mr=e=>({apiConfig:Oe(e),groupNames:ot(e),proxyProviders:st(e),delay:ne(e),showModalClosePrevConns:it(e)}),kr=S(mr)(yr);export{kr as default};
